{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "date-picker",
  "type": "registry:ui",
  "files": [
    {
      "path": "src/date-picker.tsx",
      "content": "\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput,\n} from \"@/components/ui/input-group\";\nimport {\n  addMonths,\n  format,\n  isSameDay,\n  subMonths,\n  startOfMonth,\n  endOfMonth,\n  eachDayOfInterval,\n  getDay,\n  setMonth,\n  setYear,\n  isBefore,\n  isAfter,\n  startOfDay,\n  isValid,\n} from \"date-fns\";\nimport {\n  ChevronLeftIcon,\n  ChevronRightIcon,\n  CalendarIcon,\n} from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\n// Types\ntype CalendarView = \"year\" | \"month\" | \"day\";\n\nexport type HolidaysData = {\n  [year: string]: {\n    [date: string]: string[];\n  };\n};\n\nexport type DatePickerLocale = {\n  weekDays: string[];\n  monthNames: string[];\n  today: string;\n  placeholder: string;\n  errorMessage: string;\n  dateFormat: string;\n  yearFormat: string;\n  monthFormat: string;\n  yearRangeFormat: (start: number, end: number) => string;\n  parsePatterns: RegExp[];\n  parseExamples: string[];\n};\n\nconst defaultLocale: DatePickerLocale = {\n  weekDays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  monthNames: [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ],\n  today: \"Today\",\n  placeholder: \"Enter a date\",\n  errorMessage: \"Please enter a valid date format (e.g., 20240112, 2025-01-01, 2025/01/01)\",\n  dateFormat: \"yyyy-MM-dd\",\n  yearFormat: \"yyyy\",\n  monthFormat: \"MMMM yyyy\",\n  yearRangeFormat: (start: number, end: number) => `${start} - ${end}`,\n  parsePatterns: [\n    /^(\\d{4})-(\\d{1,2})-(\\d{1,2})$/,\n    /^(\\d{4})\\/(\\d{1,2})\\/(\\d{1,2})$/,\n    /^(\\d{4})\\.\\s*(\\d{1,2})\\.\\s*(\\d{1,2})$/,\n  ],\n  parseExamples: [\"20240112\", \"2025-01-01\", \"2025/01/01\"],\n};\n\nfunction isHoliday(date: Date, holidays: HolidaysData): boolean {\n  const year = date.getFullYear().toString();\n  const dateStr = format(date, \"yyyy-MM-dd\");\n  return !!holidays[year]?.[dateStr];\n}\n\nfunction isDateSelectable(\n  date: Date,\n  minDate: Date | null,\n  maxDate: Date | null,\n  disableFuture: boolean = false,\n  disablePast: boolean = false\n): boolean {\n  const dateStart = startOfDay(date);\n  const today = startOfDay(new Date());\n\n  if (disablePast && isBefore(dateStart, today)) {\n    return false;\n  }\n\n  if (disableFuture && isAfter(dateStart, today)) {\n    return false;\n  }\n\n  if (minDate && isBefore(dateStart, startOfDay(minDate))) {\n    return false;\n  }\n\n  if (maxDate && isAfter(dateStart, startOfDay(maxDate))) {\n    return false;\n  }\n\n  return true;\n}\n\n// Shared Grid Components\ninterface DayGridProps {\n  date: Date;\n  value?: Date;\n  onChange?: (date: Date) => void;\n  holidays: HolidaysData;\n  showHolidays?: boolean;\n  minDate?: Date | null;\n  maxDate?: Date | null;\n  disableFuture?: boolean;\n  disablePast?: boolean;\n  showToday?: boolean;\n  locale: DatePickerLocale;\n}\n\nfunction DayGrid({\n  date,\n  value,\n  onChange,\n  holidays,\n  showHolidays = true,\n  minDate = null,\n  maxDate = null,\n  disableFuture = false,\n  disablePast = false,\n  showToday = false,\n  locale,\n}: DayGridProps) {\n  const daysInMonth = eachDayOfInterval({\n    start: startOfMonth(date),\n    end: endOfMonth(date),\n  });\n\n  const weekDays = locale.weekDays;\n  const firstDayOfMonth = getDay(startOfMonth(date));\n  const blankCount = firstDayOfMonth;\n  const blanks = Array(blankCount).fill(null);\n\n  const handleDateClick = (clickedDate: Date) => {\n    if (\n      isDateSelectable(\n        clickedDate,\n        minDate,\n        maxDate,\n        disableFuture,\n        disablePast\n      ) &&\n      onChange\n    ) {\n      onChange(clickedDate);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"grid grid-cols-7 mb-2 w-full text-center\">\n        {weekDays.map((day, index) => {\n          const isSun = index === 0;\n          const isSat = index === 6;\n          return (\n            <div\n              key={day}\n              className={cn(\n                \"font-medium text-slate-500 text-xs\",\n                isSun && \"text-red-500\",\n                isSat && \"text-blue-500\"\n              )}\n            >\n              {day}\n            </div>\n          );\n        })}\n      </div>\n\n      <div className=\"gap-x-0 gap-y-2 grid grid-cols-7\">\n        {blanks.map((_, i) => (\n          <div key={`blank-${i}`} />\n        ))}\n        {daysInMonth.map((day) => {\n          const isToday = isSameDay(day, new Date());\n          const isSelected = value && isSameDay(day, value);\n          const dayOfWeek = getDay(day);\n          const isSunday = dayOfWeek === 0;\n          const isSaturday = dayOfWeek === 6;\n          const isHolidayDate = showHolidays && isHoliday(day, holidays);\n          const isSelectable = isDateSelectable(\n            day,\n            minDate,\n            maxDate,\n            disableFuture,\n            disablePast\n          );\n\n          return (\n            <div key={day.toString()} className=\"flex justify-center\">\n              <button\n                type=\"button\"\n                onClick={() => handleDateClick(day)}\n                disabled={!isSelectable}\n                className={cn(\n                  \"flex justify-center items-center rounded-full w-9 h-9 text-sm transition-colors\",\n                  !isSelectable && \"opacity-30 cursor-not-allowed\",\n                  isSelected\n                    ? \"bg-slate-900 text-white font-bold\"\n                    : \"hover:bg-slate-100\",\n                  !isSelected &&\n                    isToday &&\n                    isSelectable &&\n                    showToday &&\n                    \"bg-slate-200 font-bold\",\n                  !isSelected &&\n                    !isToday &&\n                    isSelectable &&\n                    (isSunday || isHolidayDate) &&\n                    \"text-red-500\",\n                  !isSelected &&\n                    !isToday &&\n                    isSelectable &&\n                    isSaturday &&\n                    !isHolidayDate &&\n                    \"text-blue-500\"\n                )}\n              >\n                {format(day, \"d\")}\n              </button>\n            </div>\n          );\n        })}\n      </div>\n    </>\n  );\n}\n\ninterface MonthGridProps {\n  date: Date;\n  onSelect: (monthIndex: number) => void;\n  value?: Date;\n  minDate?: Date | null;\n  maxDate?: Date | null;\n  disableFuture?: boolean;\n  disablePast?: boolean;\n  locale: DatePickerLocale;\n}\n\nfunction MonthGrid({\n  date,\n  onSelect,\n  value,\n  minDate = null,\n  maxDate = null,\n  disableFuture = false,\n  disablePast = false,\n  locale,\n}: MonthGridProps) {\n  return (\n    <div className=\"gap-2 grid grid-cols-4\">\n      {locale.monthNames.map((monthName, index) => {\n        const isSelected = value\n          ? value.getFullYear() === date.getFullYear() &&\n            index === value.getMonth()\n          : index === date.getMonth();\n        const testDate = setMonth(date, index);\n        const isSelectable = isDateSelectable(\n          startOfMonth(testDate),\n          minDate,\n          maxDate,\n          disableFuture,\n          disablePast\n        );\n\n        return (\n          <Button\n            key={monthName}\n            variant={isSelected ? \"default\" : \"ghost\"}\n            disabled={!isSelectable}\n            className={cn(\n              \"h-12 font-medium text-sm\",\n              isSelected\n                ? \"bg-slate-900 text-white hover:bg-slate-800\"\n                : \"text-slate-600 hover:bg-slate-50 border-slate-200\",\n              !isSelectable && \"opacity-30 cursor-not-allowed\"\n            )}\n            onClick={() => onSelect(index)}\n          >\n            {monthName}\n          </Button>\n        );\n      })}\n    </div>\n  );\n}\n\ninterface YearGridProps {\n  date: Date;\n  onSelect: (year: number) => void;\n  value?: Date;\n  minDate?: Date | null;\n  maxDate?: Date | null;\n  disableFuture?: boolean;\n  disablePast?: boolean;\n  locale: DatePickerLocale;\n}\n\nfunction YearGrid({\n  date,\n  onSelect,\n  value,\n  minDate = null,\n  maxDate = null,\n  disableFuture = false,\n  disablePast = false,\n  locale,\n}: YearGridProps) {\n  const currentYear = new Date().getFullYear();\n  const currentYearInView = date.getFullYear();\n  const startYear = Math.floor((currentYearInView - 1) / 12) * 12 + 1;\n  const years = Array.from({ length: 12 }, (_, i) => startYear + i);\n\n  return (\n    <div className=\"gap-2 grid grid-cols-3\">\n      {years.map((year) => {\n        const isSelected = value\n          ? year === value.getFullYear()\n          : year === date.getFullYear();\n        const isSelectable =\n          (!minDate || year >= minDate.getFullYear()) &&\n          (!maxDate || year <= maxDate.getFullYear()) &&\n          (!disablePast || year >= currentYear) &&\n          (!disableFuture || year <= currentYear);\n\n        return (\n          <Button\n            key={year}\n            variant={isSelected ? \"default\" : \"ghost\"}\n            disabled={!isSelectable}\n            className={cn(\n              \"h-12 font-medium text-sm\",\n              isSelected\n                ? \"bg-slate-900 text-white hover:bg-slate-800\"\n                : \"text-slate-600 hover:bg-slate-50 border-slate-200\",\n              !isSelectable && \"opacity-30 cursor-not-allowed\"\n            )}\n            onClick={() => onSelect(year)}\n          >\n            {format(new Date(year, 0, 1), locale.yearFormat)}\n          </Button>\n        );\n      })}\n    </div>\n  );\n}\n\n// CalendarPopover Component\ninterface CalendarPopoverProps {\n  value?: Date;\n  onChange?: (date: Date) => void;\n  isOpen?: boolean;\n  showHolidays?: boolean;\n  minDate?: Date | null;\n  maxDate?: Date | null;\n  disableFuture?: boolean;\n  disablePast?: boolean;\n  showToday?: boolean;\n  holidays?: HolidaysData;\n  locale?: DatePickerLocale;\n}\n\nfunction CalendarPopover({\n  value,\n  onChange,\n  isOpen,\n  showHolidays = true,\n  minDate = null,\n  maxDate = null,\n  disableFuture = false,\n  disablePast = false,\n  showToday = false,\n  holidays = {},\n  locale = defaultLocale,\n}: CalendarPopoverProps) {\n  const [displayDate, setDisplayDate] = useState(value || new Date());\n  const [view, setView] = useState<CalendarView>(\"day\");\n\n  useEffect(() => {\n    if (value) {\n      setDisplayDate(value);\n    }\n  }, [value]);\n\n  useEffect(() => {\n    if (isOpen) {\n      setView(\"day\");\n      if (value) {\n        setDisplayDate(value);\n      }\n    }\n  }, [isOpen, value]);\n\n  const getYearRange = () => {\n    const currentYear = displayDate.getFullYear();\n    const startYear = Math.floor((currentYear - 1) / 12) * 12 + 1;\n    return Array.from({ length: 12 }, (_, i) => startYear + i);\n  };\n\n  const getHeaderText = (): string => {\n    if (view === \"year\") {\n      const years = getYearRange();\n      return locale.yearRangeFormat(years[0], years[years.length - 1]);\n    } else if (view === \"month\") {\n      return format(new Date(displayDate.getFullYear(), 0, 1), locale.yearFormat);\n    } else {\n      return format(displayDate, locale.monthFormat);\n    }\n  };\n\n  const handlePrev = () => {\n    if (view === \"year\") {\n      const currentYear = displayDate.getFullYear();\n      const startYear = Math.floor((currentYear - 1) / 12) * 12 + 1;\n      const prevStartYear = startYear - 12;\n      const newYear =\n        value &&\n        value.getFullYear() >= prevStartYear &&\n        value.getFullYear() < prevStartYear + 12\n          ? value.getFullYear()\n          : prevStartYear;\n      const newDate = setYear(displayDate, newYear);\n      setDisplayDate(newDate);\n    } else if (view === \"month\") {\n      const prevYearDate = subMonths(displayDate, 12);\n      const newMonth =\n        value && value.getFullYear() === prevYearDate.getFullYear()\n          ? value.getMonth()\n          : 0;\n      const newDate = setMonth(prevYearDate, newMonth);\n      setDisplayDate(newDate);\n    } else {\n      const prevMonthDate = subMonths(displayDate, 1);\n      if (\n        minDate &&\n        isBefore(startOfMonth(prevMonthDate), startOfMonth(minDate))\n      ) {\n        return;\n      }\n      if (\n        disablePast &&\n        isBefore(startOfMonth(prevMonthDate), startOfMonth(new Date()))\n      ) {\n        return;\n      }\n      setDisplayDate(prevMonthDate);\n    }\n  };\n\n  const handleNext = () => {\n    if (view === \"year\") {\n      const currentYear = displayDate.getFullYear();\n      const startYear = Math.floor((currentYear - 1) / 12) * 12 + 1;\n      const nextStartYear = startYear + 12;\n      const newYear =\n        value &&\n        value.getFullYear() >= nextStartYear &&\n        value.getFullYear() < nextStartYear + 12\n          ? value.getFullYear()\n          : nextStartYear;\n      const newDate = setYear(displayDate, newYear);\n      setDisplayDate(newDate);\n    } else if (view === \"month\") {\n      const nextYearDate = addMonths(displayDate, 12);\n      const newMonth =\n        value && value.getFullYear() === nextYearDate.getFullYear()\n          ? value.getMonth()\n          : 0;\n      const newDate = setMonth(nextYearDate, newMonth);\n      setDisplayDate(newDate);\n    } else {\n      const nextMonthDate = addMonths(displayDate, 1);\n      if (\n        maxDate &&\n        isAfter(startOfMonth(nextMonthDate), startOfMonth(maxDate))\n      ) {\n        return;\n      }\n      if (\n        disableFuture &&\n        isAfter(startOfMonth(nextMonthDate), startOfMonth(new Date()))\n      ) {\n        return;\n      }\n      setDisplayDate(nextMonthDate);\n    }\n  };\n\n  const handleHeaderClick = () => {\n    if (view === \"day\") {\n      setView(\"month\");\n    } else if (view === \"month\") {\n      setView(\"year\");\n    }\n  };\n\n  const handleYearSelect = (year: number) => {\n    const newDate = setYear(displayDate, year);\n    const currentYear = new Date().getFullYear();\n    if (minDate && year < minDate.getFullYear()) {\n      return;\n    }\n    if (maxDate && year > maxDate.getFullYear()) {\n      return;\n    }\n    if (disablePast && year < currentYear) {\n      return;\n    }\n    if (disableFuture && year > currentYear) {\n      return;\n    }\n    setDisplayDate(newDate);\n    setView(\"month\");\n  };\n\n  const handleMonthSelect = (monthIndex: number) => {\n    const newDate = setMonth(displayDate, monthIndex);\n    if (\n      !isDateSelectable(\n        startOfMonth(newDate),\n        minDate,\n        maxDate,\n        disableFuture,\n        disablePast\n      )\n    ) {\n      return;\n    }\n    setDisplayDate(newDate);\n    setView(\"day\");\n  };\n\n  const handleDateSelect = (date: Date) => {\n    if (onChange) {\n      onChange(date);\n    }\n  };\n\n  const handleTodayClick = () => {\n    const today = new Date();\n    if (\n      isDateSelectable(today, minDate, maxDate, disableFuture, disablePast) &&\n      onChange\n    ) {\n      onChange(today);\n    }\n  };\n\n  const canGoPrev = () => {\n    if (view === \"year\" || view === \"month\") {\n      return true;\n    }\n    const prevMonthDate = subMonths(displayDate, 1);\n    return (\n      (!minDate ||\n        !isBefore(startOfMonth(prevMonthDate), startOfMonth(minDate))) &&\n      (!disablePast ||\n        !isBefore(startOfMonth(prevMonthDate), startOfMonth(new Date())))\n    );\n  };\n\n  const canGoNext = () => {\n    if (view === \"year\" || view === \"month\") {\n      return true;\n    }\n    const nextMonthDate = addMonths(displayDate, 1);\n    return (\n      (!maxDate ||\n        !isAfter(startOfMonth(nextMonthDate), startOfMonth(maxDate))) &&\n      (!disableFuture ||\n        !isAfter(startOfMonth(nextMonthDate), startOfMonth(new Date())))\n    );\n  };\n\n  return (\n    <div className=\"bg-white shadow-sm border border-slate-200 rounded-lg\">\n      <div className=\"flex justify-between items-center p-4 border-b\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={handlePrev}\n          disabled={!canGoPrev()}\n          className={cn(!canGoPrev() && \"opacity-50 cursor-not-allowed\")}\n        >\n          <ChevronLeftIcon className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={handleHeaderClick}\n          className=\"font-medium\"\n        >\n          {getHeaderText()}\n        </Button>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={handleNext}\n          disabled={!canGoNext()}\n          className={cn(!canGoNext() && \"opacity-50 cursor-not-allowed\")}\n        >\n          <ChevronRightIcon className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      <div className=\"p-4 w-70\">\n        {view === \"year\" && (\n          <YearGrid\n            date={displayDate}\n            onSelect={handleYearSelect}\n            value={value}\n            minDate={minDate}\n            maxDate={maxDate}\n            disableFuture={disableFuture}\n            disablePast={disablePast}\n            locale={locale}\n          />\n        )}\n        {view === \"month\" && (\n          <MonthGrid\n            date={displayDate}\n            onSelect={handleMonthSelect}\n            value={value}\n            minDate={minDate}\n            maxDate={maxDate}\n            disableFuture={disableFuture}\n            disablePast={disablePast}\n            locale={locale}\n          />\n        )}\n        {view === \"day\" && (\n          <DayGrid\n            date={displayDate}\n            value={value}\n            onChange={handleDateSelect}\n            holidays={holidays}\n            showHolidays={showHolidays}\n            minDate={minDate}\n            maxDate={maxDate}\n            disableFuture={disableFuture}\n            disablePast={disablePast}\n            showToday={showToday}\n            locale={locale}\n          />\n        )}\n      </div>\n\n      {view === \"day\" && value && !isSameDay(value, new Date()) && (\n        <div className=\"flex justify-center items-center p-3 border-t\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleTodayClick}\n            disabled={\n              !isDateSelectable(\n                new Date(),\n                minDate,\n                maxDate,\n                disableFuture,\n                disablePast\n              )\n            }\n            className={cn(\n              \"w-full\",\n              !isDateSelectable(\n                new Date(),\n                minDate,\n                maxDate,\n                disableFuture,\n                disablePast\n              ) && \"opacity-50 cursor-not-allowed\"\n            )}\n          >\n            {locale.today}\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// DatePicker Component\nexport interface DatePickerProps {\n  value?: Date;\n  onChange?: (date: Date) => void;\n  displayFormat?: string;\n  showHolidays?: boolean;\n  minDate?: Date | null;\n  maxDate?: Date | null;\n  disableFuture?: boolean;\n  disablePast?: boolean;\n  showToday?: boolean;\n  holidays?: HolidaysData;\n  locale?: Partial<DatePickerLocale>;\n}\n\nexport function DatePicker({\n  value,\n  onChange,\n  displayFormat,\n  showHolidays = true,\n  minDate = null,\n  maxDate = null,\n  disableFuture = false,\n  disablePast = false,\n  showToday = false,\n  holidays = {},\n  locale: localePartial = {},\n}: DatePickerProps) {\n  const locale: DatePickerLocale = {\n    ...defaultLocale,\n    ...localePartial,\n  };\n\n  const formatStr = displayFormat || locale.dateFormat;\n\n  const [inputValue, setInputValue] = useState(\"\");\n  const [isInvalid, setIsInvalid] = useState(false);\n  const [open, setOpen] = useState(false);\n\n  useEffect(() => {\n    if (value) {\n      setInputValue(format(value, formatStr));\n      setIsInvalid(false);\n    } else {\n      setInputValue(\"\");\n    }\n  }, [value, formatStr]);\n\n  const extractNumbers = (str: string): string => {\n    return str.replace(/\\D/g, \"\");\n  };\n\n  const parseDateFromString = (input: string): Date | null => {\n    const trimmed = input.trim();\n    if (!trimmed) return null;\n\n    for (const pattern of locale.parsePatterns) {\n      const match = trimmed.match(pattern);\n      if (match) {\n        const year = parseInt(match[1], 10);\n        const month = parseInt(match[2], 10);\n        const day = parseInt(match[3], 10);\n        if (\n          year >= 1900 &&\n          year <= 2100 &&\n          month >= 1 &&\n          month <= 12 &&\n          day >= 1 &&\n          day <= 31\n        ) {\n          const date = new Date(year, month - 1, day);\n          if (\n            isValid(date) &&\n            date.getFullYear() === year &&\n            date.getMonth() === month - 1 &&\n            date.getDate() === day\n          ) {\n            return date;\n          }\n        }\n      }\n    }\n\n    return null;\n  };\n\n  const parseAndFormatDate = (\n    input: string\n  ): { formatted: string; date: Date | null } => {\n    const trimmed = input.trim();\n    if (!trimmed) {\n      return { formatted: \"\", date: null };\n    }\n\n    const parsedDate = parseDateFromString(trimmed);\n    if (parsedDate) {\n      return {\n        formatted: format(parsedDate, formatStr),\n        date: parsedDate,\n      };\n    }\n\n    const numbers = extractNumbers(trimmed);\n    if (numbers.length === 0) {\n      return { formatted: \"\", date: null };\n    }\n\n    if (numbers.length === 8) {\n      const year = parseInt(numbers.slice(0, 4), 10);\n      const month = parseInt(numbers.slice(4, 6), 10);\n      const day = parseInt(numbers.slice(6, 8), 10);\n\n      if (\n        year >= 1900 &&\n        year <= 2100 &&\n        month >= 1 &&\n        month <= 12 &&\n        day >= 1 &&\n        day <= 31\n      ) {\n        const date = new Date(year, month - 1, day);\n        if (\n          isValid(date) &&\n          date.getFullYear() === year &&\n          date.getMonth() === month - 1 &&\n          date.getDate() === day\n        ) {\n          return {\n            formatted: format(date, formatStr),\n            date,\n          };\n        }\n      }\n    }\n\n    if (numbers.length === 7) {\n      const year = parseInt(numbers.slice(0, 4), 10);\n      const rest = numbers.slice(4);\n\n      if (year < 1900 || year > 2100) {\n        return { formatted: numbers, date: null };\n      }\n\n      const monthFirstDigit = parseInt(rest[0], 10);\n      const dayFirstDigit = parseInt(rest[2], 10);\n\n      if (monthFirstDigit >= 2) {\n        const month = monthFirstDigit;\n        const day = parseInt(rest[2], 10);\n        if (day >= 1 && day <= 9) {\n          const date = new Date(year, month - 1, day);\n          if (\n            isValid(date) &&\n            date.getFullYear() === year &&\n            date.getMonth() === month - 1 &&\n            date.getDate() === day\n          ) {\n            return {\n              formatted: format(date, formatStr),\n              date,\n            };\n          }\n        }\n      } else if (monthFirstDigit === 1) {\n        const month = parseInt(rest.slice(0, 2), 10);\n        if (month >= 10 && month <= 12) {\n          const day = parseInt(rest[2], 10);\n          if (day >= 1 && day <= 9) {\n            const date = new Date(year, month - 1, day);\n            if (\n              isValid(date) &&\n              date.getFullYear() === year &&\n              date.getMonth() === month - 1 &&\n              date.getDate() === day\n            ) {\n              return {\n                formatted: format(date, formatStr),\n                date,\n              };\n            }\n          }\n        }\n      }\n\n      if (monthFirstDigit >= 2) {\n        const month = monthFirstDigit;\n        const day = parseInt(rest.slice(1), 10);\n        if (day >= 1 && day <= 31) {\n          const date = new Date(year, month - 1, day);\n          if (\n            isValid(date) &&\n            date.getFullYear() === year &&\n            date.getMonth() === month - 1 &&\n            date.getDate() === day\n          ) {\n            return {\n              formatted: format(date, formatStr),\n              date,\n            };\n          }\n        }\n      } else if (monthFirstDigit === 1) {\n        if (dayFirstDigit >= 4) {\n          const month = 1;\n          const day = parseInt(rest.slice(1), 10);\n          if (day >= 1 && day <= 31) {\n            const date = new Date(year, month - 1, day);\n            if (\n              isValid(date) &&\n              date.getFullYear() === year &&\n              date.getMonth() === month - 1 &&\n              date.getDate() === day\n            ) {\n              return {\n                formatted: format(date, formatStr),\n                date,\n              };\n            }\n          }\n        } else {\n          const month = 1;\n          const day = parseInt(rest.slice(1), 10);\n          if (day >= 1 && day <= 31) {\n            const date = new Date(year, month - 1, day);\n            if (\n              isValid(date) &&\n              date.getFullYear() === year &&\n              date.getMonth() === month - 1 &&\n              date.getDate() === day\n            ) {\n              return {\n                formatted: format(date, formatStr),\n                date,\n              };\n            }\n          }\n        }\n      }\n    }\n\n    if (numbers.length === 6) {\n      const year = parseInt(numbers.slice(0, 4), 10);\n      const month = parseInt(numbers.slice(4, 6), 10);\n\n      if (year >= 1900 && year <= 2100 && month >= 1 && month <= 12) {\n        const date = new Date(year, month - 1, 1);\n        if (isValid(date)) {\n          return {\n            formatted: format(date, formatStr),\n            date,\n          };\n        }\n      }\n    }\n\n    if (numbers.length === 5) {\n      const year = parseInt(numbers.slice(0, 4), 10);\n      const firstDigit = parseInt(numbers[4], 10);\n\n      if (year >= 1900 && year <= 2100) {\n        if (firstDigit >= 2 && firstDigit <= 9) {\n          const month = firstDigit;\n          const date = new Date(year, month - 1, 1);\n          if (isValid(date)) {\n            return {\n              formatted: format(date, formatStr),\n              date,\n            };\n          }\n        } else if (firstDigit === 1) {\n          const date = new Date(year, 0, 1);\n          if (isValid(date)) {\n            return {\n              formatted: format(date, formatStr),\n              date,\n            };\n          }\n        }\n      }\n    }\n\n    return { formatted: numbers, date: null };\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = e.target.value;\n    setInputValue(newValue);\n    setIsInvalid(false);\n  };\n\n  const handleInputBlur = () => {\n    if (!inputValue.trim()) {\n      setIsInvalid(false);\n      return;\n    }\n\n    const { formatted, date } = parseAndFormatDate(inputValue);\n    if (date) {\n      setInputValue(formatted);\n      setIsInvalid(false);\n      if (onChange) {\n        onChange(date);\n      }\n    } else {\n      setIsInvalid(true);\n    }\n  };\n\n  const handleInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      const { formatted, date } = parseAndFormatDate(inputValue);\n      if (date) {\n        setInputValue(formatted);\n        setIsInvalid(false);\n        if (onChange) {\n          onChange(date);\n        }\n      } else {\n        setIsInvalid(true);\n      }\n      e.currentTarget.blur();\n    }\n  };\n\n  const handleCalendarSelect = (date: Date) => {\n    setInputValue(format(date, formatStr));\n    setIsInvalid(false);\n    if (onChange) {\n      onChange(date);\n    }\n    setOpen(false);\n  };\n\n  return (\n    <div className=\"relative\">\n      <InputGroup className={cn(isInvalid && \"border-destructive\")}>\n        <InputGroupInput\n          type=\"text\"\n          value={inputValue}\n          onChange={handleInputChange}\n          onBlur={handleInputBlur}\n          onKeyDown={handleInputKeyDown}\n          placeholder={locale.placeholder}\n          aria-invalid={isInvalid}\n        />\n        <InputGroupAddon align=\"inline-end\">\n          <Popover open={open} onOpenChange={setOpen}>\n            <PopoverTrigger asChild>\n              <InputGroupButton type=\"button\" size=\"icon-xs\">\n                <CalendarIcon className=\"w-4 h-4\" />\n              </InputGroupButton>\n            </PopoverTrigger>\n            <PopoverContent className=\"p-0 w-auto\" align=\"end\">\n              <CalendarPopover\n                value={value}\n                onChange={handleCalendarSelect}\n                isOpen={open}\n                showHolidays={showHolidays}\n                minDate={minDate}\n                maxDate={maxDate}\n                disableFuture={disableFuture}\n                disablePast={disablePast}\n                showToday={showToday}\n                holidays={holidays}\n                locale={locale}\n              />\n            </PopoverContent>\n          </Popover>\n        </InputGroupAddon>\n      </InputGroup>\n      {isInvalid && (\n        <p className=\"mt-1 text-destructive text-sm\">\n          {locale.errorMessage}\n        </p>\n      )}\n    </div>\n  );\n}\n",
      "target": "components/ui/date-picker.tsx",
      "type": "registry:component"
    }
  ],
  "dependencies": [
    "date-fns",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "popover",
    "input-group"
  ]
}